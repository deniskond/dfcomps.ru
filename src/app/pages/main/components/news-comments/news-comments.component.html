<div *ngIf="!isExpanded; else expanded">
    <a (click)="toggleExpand()" class="expand-link">Комментарии ({{ comments.length }})</a>
</div>
<ng-template #expanded>
    <div (click)="toggleExpand()" class="hide-comments">Скрыть комментарии</div>

    <ng-container *ngIf="(comments$ | async) as comments">
        <ng-container *ngFor="let comment of comments; let i = index;">
            <div class="comment">
                <div class="comment-header">
                    <div class="comment-header-left">
                        <span>#{{ i + 1 }}</span>
                        <span class="separator"></span>
                        <span>{{ comment.username }}</span>
                        <span class="separator"></span>
                        <a href="#">Удалить</a>
                    </div>
                    <div class="comment-header-right">
                        {{ comment.datetime }}
                    </div>
                </div>
                <div [innerHTML]="comment.smilesComment" class="comment-inner"></div>
            </div>
        </ng-container>
    </ng-container>

    <div class="write-commentary">Написать комментарий:</div>
    <div #textarea contenteditable="true" class="comment-textarea"></div>
    <button mat-raised-button (click)="sendComment()" color="primary" class="add-comment-button">
        Отправить
    </button>
</ng-template>